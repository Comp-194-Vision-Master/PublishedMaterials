<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Susan Eileen Fox">
<meta name="dcterms.date" content="2025-08-12">

<title>ICA: While Loops and Webcams/Video</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="ICA10-WhileAndVideo_files/libs/clipboard/clipboard.min.js"></script>
<script src="ICA10-WhileAndVideo_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="ICA10-WhileAndVideo_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="ICA10-WhileAndVideo_files/libs/quarto-html/popper.min.js"></script>
<script src="ICA10-WhileAndVideo_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ICA10-WhileAndVideo_files/libs/quarto-html/anchor.min.js"></script>
<link href="ICA10-WhileAndVideo_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ICA10-WhileAndVideo_files/libs/quarto-html/quarto-syntax-highlighting-226bd0f977fa82dfae4534cac220d79a.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ICA10-WhileAndVideo_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ICA10-WhileAndVideo_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ICA10-WhileAndVideo_files/libs/bootstrap/bootstrap-c9dc05ccd9e6568c662515419180efc4.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="quarto-light">

<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ICA: While Loops and Webcams/Video</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Susan Eileen Fox </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 12, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#while-loops" id="toc-while-loops" class="nav-link" data-scroll-target="#while-loops"><code>while</code> loops</a>
  <ul class="collapse">
  <li><a href="#first-example" id="toc-first-example" class="nav-link" data-scroll-target="#first-example">First example</a></li>
  <li><a href="#second-example" id="toc-second-example" class="nav-link" data-scroll-target="#second-example">Second example</a></li>
  <li><a href="#accumulator-variables" id="toc-accumulator-variables" class="nav-link" data-scroll-target="#accumulator-variables">Accumulator variables</a></li>
  <li><a href="#the-break-statement" id="toc-the-break-statement" class="nav-link" data-scroll-target="#the-break-statement">The break Statement</a></li>
  </ul></li>
  <li><a href="#working-with-video" id="toc-working-with-video" class="nav-link" data-scroll-target="#working-with-video">Working with Video</a>
  <ul class="collapse">
  <li><a href="#ending-the-program-with-key-input" id="toc-ending-the-program-with-key-input" class="nav-link" data-scroll-target="#ending-the-program-with-key-input">Ending the program with key input</a></li>
  </ul></li>
  <li><a href="#what-to-hand-in" id="toc-what-to-hand-in" class="nav-link" data-scroll-target="#what-to-hand-in">What to hand in</a></li>
  </ul>
</nav>
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="overview" class="level1">
<h1>Overview</h1>
<p>In this activity, we will explore how to use the <code>while</code> loop to loop an uncertain, <strong>indefinite</strong>, number of times, and we will use <code>while</code> loops to help us to work with webcam video feeds, or stored video files.</p>
<p>The Github repository for this assignment will contain a starter code file, <code>activ10.py</code>. Put your code in this file, as directed by the <code>TODO</code> comments.</p>
</section>
<section id="while-loops" class="level1">
<h1><code>while</code> loops</h1>
<p>A while loop starts with a Boolean test expression, and then has a block of indented Python statements in its body. As long as the test expression evaluates to True, the program keeps repeating the statements in the loop body, and then re-checking the test expression. It stops only when the test evaluates to False.</p>
<div id="27254147" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="cf">while</span> boolean<span class="op">-</span>expression:</span>
<span id="cb1-2"><a href="#cb1-2"></a>  loop<span class="op">-</span>body</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In a <code>for</code> loop the loop variable is very obvious; it is declared as a part of the main line of the loop. The <code>while</code> loop also must have a loop variable, but sometimes it is harder to figure out. Often, it actually follows the accumulator pattern!</p>
<p>There are typically at least three statements involved in the loop that related to the loop variable:</p>
<ul>
<li>A statement assigning the loop variable to an initial value before the loop</li>
<li>The boolean expression that controls the loop, comparing the loop variable to something</li>
<li>A statement inside the loop that modifies the value of the loop variable</li>
</ul>
<p>In the example below, the loop variable is <code>count</code>. It is initialized to 1 in the first line, it is compared to <code>total</code> in the boolean test of the <code>while</code> loop, and it is incremented in the last line inside the <code>while</code> loop.</p>
<div id="28795afc" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>count <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="cf">while</span> count <span class="op">&lt;=</span> <span class="dv">5</span>:</span>
<span id="cb2-3"><a href="#cb2-3"></a>  <span class="bu">print</span>(count)</span>
<span id="cb2-4"><a href="#cb2-4"></a>  count <span class="op">=</span> count <span class="op">+</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1
2
3
4
5</code></pre>
</div>
</div>
<p>In the sections below, we will see examples of functions that use <code>while</code> loops. These files are in your starter code file. For each function, do the following:</p>
<ul>
<li>First, create a sample call with small but non-trivial values for input parameters</li>
<li>Walk through the function by hand and predict its behavior</li>
<li>Then, add that call, and some other sample calls, to the code file (in the script at the bottom)</li>
<li>Verify that the results look correct</li>
<li>Practice using the debugger to step through the loop one line at a time, watching how the variables change.</li>
</ul>
<section id="first-example" class="level2">
<h2 class="anchored" data-anchor-id="first-example">First example</h2>
<p>This function takes in an integer input, and it prints every other number from that input value down to zero. Then it prints Done!.</p>
<div id="472cdd40" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">def</span> printEveryOther(x):</span>
<span id="cb4-2"><a href="#cb4-2"></a>    <span class="cf">while</span> x <span class="op">&gt;=</span> <span class="dv">0</span>:  <span class="co"># x is the loop variable</span></span>
<span id="cb4-3"><a href="#cb4-3"></a>        <span class="bu">print</span>(x)</span>
<span id="cb4-4"><a href="#cb4-4"></a>        x <span class="op">=</span> x <span class="op">-</span> <span class="dv">2</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>    <span class="co"># when indentation stops, while loop is over</span></span>
<span id="cb4-6"><a href="#cb4-6"></a>    <span class="bu">print</span>(<span class="st">"Done!"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>What happens when you put a typical value into this function?</li>
<li>What happens if you put a negative value into the function?</li>
<li>What happens if you change the boolean test to be x &gt;= 5?</li>
</ul>
<p>Work through a call to this function by hand, figuring out the effect of each and every line and repetition; consider a call like <code>printEveryOther(7)</code>.</p>
<p><strong>Try this to hand in:</strong> Make a copy of <code>printEveryOther</code> function, called <code>printEveryFifth</code>, that prints every fifth value from x down to zero. Below are a couple of sample calls to show how this function should work:</p>
<div id="f0a13299" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>printEveryFifth(<span class="dv">20</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>printEveryFifth(<span class="dv">11</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>20
15
10
5
0
Done!
11
6
1
Done!</code></pre>
</div>
</div>
</section>
<section id="second-example" class="level2">
<h2 class="anchored" data-anchor-id="second-example">Second example</h2>
<p>The next example shows the indeterminate nature of a while loop. In this case, the loop repeats until the user enters a negative number, printing the square of each number the user enters.</p>
<div id="e2c1c991" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">def</span> squareUserNums():</span>
<span id="cb7-2"><a href="#cb7-2"></a>  <span class="co"># Initialize loop variable </span></span>
<span id="cb7-3"><a href="#cb7-3"></a>  userInp <span class="op">=</span> <span class="bu">input</span>(<span class="st">"Enter the next number (negative to quit): "</span>)</span>
<span id="cb7-4"><a href="#cb7-4"></a>  userNum <span class="op">=</span> <span class="bu">int</span>(userInp)</span>
<span id="cb7-5"><a href="#cb7-5"></a>  <span class="cf">while</span> userNum <span class="op">&gt;=</span> <span class="dv">0</span>:</span>
<span id="cb7-6"><a href="#cb7-6"></a>    <span class="bu">print</span>(userNum, <span class="st">"squared is"</span>, userNum <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb7-7"><a href="#cb7-7"></a>    userInp <span class="op">=</span> <span class="bu">input</span>(<span class="st">"Enter the next number (negative to quit): "</span>)</span>
<span id="cb7-8"><a href="#cb7-8"></a>    userNum <span class="op">=</span> <span class="bu">int</span>(userInp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Experiment with this function. Notice that the first two lines of the function are repeated again inside the while loop. Why is that?</p>
</section>
<section id="accumulator-variables" class="level2">
<h2 class="anchored" data-anchor-id="accumulator-variables">Accumulator variables</h2>
<p>We can use accumulator variables with while loops just like we do with for loops. The accumulator is set to some initial value before the loop, and then updated each time through the loop. See the examples below.</p>
<div id="5b87e9c5" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">def</span> sumToN(topNum):</span>
<span id="cb8-2"><a href="#cb8-2"></a>  <span class="co">"""Takes in a number and computes and returns the sum of the numbers</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">  from zero to the input number."""</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>  currVal <span class="op">=</span> <span class="dv">0</span>   <span class="co"># the loop variable</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>  total <span class="op">=</span> <span class="dv">0</span>     <span class="co"># the accumulator variable</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>  <span class="cf">while</span> currVal <span class="op">&lt;</span> topNum:</span>
<span id="cb8-7"><a href="#cb8-7"></a>    total <span class="op">=</span> total <span class="op">+</span> currVal <span class="co"># add next value to accumulator</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>    currVal <span class="op">=</span> currVal <span class="op">+</span> <span class="dv">1</span>  <span class="co"># update the loop variable</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="cf">return</span> total</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Experiment with this function. Walk through what happens if you call this with some small value, like 4.</p>
<ul>
<li>Walk through the function by hand with your teammate/neighbor</li>
<li>Try either adding print statements to see what happens in the loop, or using the debugger to watch how <code>total</code> and <code>currVal</code> change</li>
</ul>
<p>** Try this to hand in:** Write a function <code>addUserNums</code> that has no input arguments. Here are the steps for this function, written in <em>pseudocode</em>:</p>
<ul>
<li>Initialize <code>sumOfNums</code>, an accumulator variable, to zero</li>
<li>Ask the user for a number (be sure to convert their input from string to number)</li>
<li>Loop until the user enters the value 0
<ul>
<li>Update <code>sumOfNums</code> by adding the user’s number to it.</li>
<li>Ask again for the user to enter a number.</li>
</ul></li>
<li>return <code>sumOfNums</code></li>
</ul>
</section>
<section id="the-break-statement" class="level2">
<h2 class="anchored" data-anchor-id="the-break-statement">The break Statement</h2>
<p>Sometimes you want the option to stop looping if special circumstances occur, before the natural end of the loop. The break statement causes the current loop to stop immediately at the point where the break occurred. The program continues on with any Python statements that come after the loop.</p>
<p>The program below loops over characters in a string, adding them to an accumulator variable. It breaks out of the <code>for</code> loop when the next character is a space, tab, or newline, and returns the string it has built so far.</p>
<div id="8c28107c" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">def</span> nextWord(text):</span>
<span id="cb9-2"><a href="#cb9-2"></a>  <span class="co">"""Takes in a string of text and builds and returns a new string</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">  that is the next "word" in the text. In other words, the next</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">  sequence of characters up to a space, tab, or newline."""</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>  wordStr <span class="op">=</span> <span class="st">""</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>  i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>  <span class="cf">for</span> ch <span class="kw">in</span> text:</span>
<span id="cb9-8"><a href="#cb9-8"></a>    <span class="cf">if</span> ch <span class="kw">in</span> <span class="st">" </span><span class="ch">\t\n</span><span class="st">"</span>:  <span class="co"># if character is space, tab (\t), or newline (\n)</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>      <span class="cf">break</span></span>
<span id="cb9-10"><a href="#cb9-10"></a>    <span class="cf">else</span>:</span>
<span id="cb9-11"><a href="#cb9-11"></a>      wordStr <span class="op">=</span> wordStr <span class="op">+</span> ch</span>
<span id="cb9-12"><a href="#cb9-12"></a>  <span class="cf">return</span> wordStr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Try this to hand in:</strong> We’re going to rewrite the <code>squareUserNums</code> function from earlier to avoid repeating the two lines that get the next number from the user. To do so, we will use a common: <code>while True</code> combined with <code>break</code>.</p>
<p>Do this first:</p>
<ul>
<li>Copy the definition of <code>squareUserNums</code> from earlier and change its name to <code>squareUserNums2</code>.</li>
<li>Remove the two lines before the <code>while</code> loop (the call to <code>input</code> and the call to <code>int</code>).</li>
<li>Change the boolean expression test of the <code>while</code> statement to be just the boolean value <code>True</code>, as shown below:</li>
</ul>
<div id="d42c7cbe" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">def</span> squareUserNums2():</span>
<span id="cb10-2"><a href="#cb10-2"></a>  <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb10-3"><a href="#cb10-3"></a>    ...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using <code>True</code> as the test expression is a way to create a loop that never ends. Inside the loop, we can use an <code>if</code> statement to break out of the loop when conditions are right.</p>
<p>Next, move around the pieces inside the while loop, and add an if statement:</p>
<ul>
<li>Inside the <code>while</code> loop in <code>squareUserNums</code>, move the last two lines (where <code>userInp</code> and <code>userNum</code> are defined) to be the first statements inside the <code>while</code> loop.</li>
<li>After those two lines, and before the <code>print</code> call, add an <code>if</code> statement. If <code>userNum</code> is less than zero, then <code>break</code>.</li>
</ul>
<p>This function should behave just like the earlier one, but without the copied lines.</p>
</section>
</section>
<section id="working-with-video" class="level1">
<h1>Working with Video</h1>
<p>The table below lists the main functions you need in order to access frames from the computer’s camera. First there is the function VideoCapture, which takes one input and creates a VideoCapture object. The one input specifies which camera connected to the computer should be used (zero is the default: the built-in camera if there is one). Three methods belonging to the VideoCapture object are shown, as well.</p>
<table class="caption-top table">
<colgroup>
<col style="width: 32%">
<col style="width: 67%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Examples</th>
<th style="text-align: left;">Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>cap = cv2.VideoCapture(0)</code></td>
<td style="text-align: left;">Creates a VideoCapture object connected to specified camera</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>cap.isOpened()</code></td>
<td style="text-align: left;">Boolean method returns true if camera connection succeeded</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>ret, image = cap.read()</code></td>
<td style="text-align: left;">Returns a boolean (was read successful) and a frame</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>cap.release()</code></td>
<td style="text-align: left;">Disconnects from camera</td>
</tr>
</tbody>
</table>
<p>Start with the script below to get images from a built-in camera. <strong>If your computer does not have a built-in webcam, see Susan to get an external webcam!</strong></p>
<p>You are going to improve this script.</p>
<div id="4b89c442" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1"></a><span class="im">import</span> cv2</span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw">def</span> videoFeeder(camOrFile <span class="op">=</span> <span class="dv">0</span>):</span>
<span id="cb11-4"><a href="#cb11-4"></a>    vidCap <span class="op">=</span> cv2.VideoCapture(<span class="dv">0</span>)</span>
<span id="cb11-5"><a href="#cb11-5"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb11-6"><a href="#cb11-6"></a>        ret, img <span class="op">=</span> vidCap.read()   <span class="co"># Read a frame from the video camera</span></span>
<span id="cb11-7"><a href="#cb11-7"></a>        cv2.imshow(<span class="st">"Webcam"</span>, img)  <span class="co"># Display the frame</span></span>
<span id="cb11-8"><a href="#cb11-8"></a>        cv2.waitKey(<span class="dv">10</span>)            <span class="co"># Wait 10 milliseconds and then go on</span></span>
<span id="cb11-9"><a href="#cb11-9"></a>    </span>
<span id="cb11-10"><a href="#cb11-10"></a>    vidCap.release()</span>
<span id="cb11-11"><a href="#cb11-11"></a>    </span>
<span id="cb11-12"><a href="#cb11-12"></a>videoFeeder()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="ending-the-program-with-key-input" class="level2">
<h2 class="anchored" data-anchor-id="ending-the-program-with-key-input">Ending the program with key input</h2>
<p>Be sure to check the readings for today for how to use <code>waitKey</code> to get the key the user pressed.</p>
<ul>
<li>Modify the code above like the example in Chapter 3 of our <em>Vision</em> readings, so that it catches the value returned by <code>waitKey</code> and checks it to see if the value is -1. If not, convert it to a character with <code>chr</code> and see if the user typed <code>'q'</code>. Break out of the loop if so.</li>
<li>Add a function called <code>processImage</code> to the file. It should take in an image and return an image. For now just have it return the image it is passed (we will add functionality in later steps).</li>
<li>Insert a call to <code>processImage</code> in between the <code>vidCap.read()</code> line and the <code>cv2.imshow</code> line. Pass <code>img</code> to <code>processImage</code>, and assign the returned image to <code>img2</code>.</li>
<li>Change the displayed image to be <code>img2</code>.</li>
</ul>
<p>Now that you have a functioning video streaming program, let’s start making improvements.</p>
<p>Try to hold something up in front of the camera while your program is running, and then move the object to the different corners of the video image. Did you find yourself moving the wrong way? We often have trouble with left and right movements on a video feed, because we are more used to seeing a mirror image of ourselves. We can use the OpenCv function <code>flip</code> to flip the image. This function will flip an image upside down, or left-to-right.</p>
<div id="e838fdfc" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1"></a>flippedIm <span class="op">=</span> cv2.flip(img, flipCode)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>flip</code> function takes in an image and a <em>flip code</em> which specifies whether to flip around the horizontal axis, or around the vertical one. It returns a new image. A flip code of 0 will flip a picture upside down (around the horizontal axis), and a flip code of 1 will flip a pictures left-to-right (around the vertical axis).</p>
<p><strong>Try this to hand in:</strong> For this task, you will add an option of display the flipped version of the video feed.</p>
<ul>
<li>Modify your <code>processImage</code> function so that it takes in an extra input: <code>doFlip</code>. When <code>doFlip</code> is <code>True</code>, the function should call the <code>flip</code> function, using flip code 1, and should return the resulting image. When <code>doFlip</code> is <code>False</code>, the function should return the original image.</li>
<li>In your main program, you will need to set up a boolean <em>flag</em> variable. This is a special kind of accumulator variable that just holds <code>True</code> or <code>False</code>. We call it a <em>flag</em> variable because it signals when a certain condition holds
<ul>
<li>Before the <code>while True</code> loop, set up the flag variable to be <code>False</code></li>
<li>Inside the loop, add the flag variable to the call to <code>processImage</code></li>
<li>Add to the <code>if</code> statement that checks the user’s input key: if the user hits the f key, we want to <em>toggle</em> the value of the flag variable: if it was <code>False</code>, it should become <code>True</code>, and vice versa.</li>
</ul></li>
</ul>
<p><strong>Try this to hand in:</strong> Suppose that you wanted to be able to save individual frames from the video feed to image files.</p>
<ul>
<li>Add to the <code>if</code> statement that checks the user’s input key, so that it checks if the user hits the s key</li>
<li>When the user hits that, save the current image to a file, using the <code>cv2.imwrite</code> function. This function takes two inputs: (1) a string for the filename of the file to save to, including <code>.jpg</code> or <code>.png</code> as the filename extension, and (2) the image you want to save.</li>
</ul>
<div id="670bf1e9" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1"></a>cv2.imwrite(<span class="st">"screenshot.jpg"</span>, frame)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>For an extra, optional challenge, give each screenshot a unique filename, so that you can save any number you want. (Adding a counter to the loop, and attaching the counter to the filename is a great way to do this.)</p>
<p><strong>Try this to hand in:</strong> Let’s apply the color shuffle function from the previous activity to the video feed.</p>
<ul>
<li>Find your implementation of <code>colorShuffle</code> and copy it into this code file (if you didn’t complete it, ask for help from a partner, preceptor, or instructor).</li>
<li>Add a call to <code>colorShuffle</code> to your <code>processImage</code> function. For this one, we won’t require that the user hit a key to trigger it, it should just get called every time.</li>
</ul>
<p><strong>What happens?</strong></p>
<p>What should have happened was a bit of chaos: the color scheme should flicker from frame to frame into different color patterns. How could we fix this?</p>
<p><strong>Optional fix:</strong> A better model than just random shuffling every frame might be to trigger a shuffle <em>pattern</em> every time the user hits a particular key, and then keep that shuffle pattern from then on until the user selects another pattern. A shuffle pattern needs to tell us which of the original channels should go in which new channel position. For example, if the pattern was <code>[0, 2, 1]</code> then the blue channel would stay in the same place, but the red and green channels would be swapped. Every ordering of the values 0, 1, and 2 in the list corresponds to a unique shuffle, and all shuffles can be represented by a pattern. We would need to <em>decode</em> the pattern to determine how to split and re-merge the frame’s channels.</p>
<p>If you have time and interest, here are steps you could implement for this.</p>
<ul>
<li>Set up a <code>pattern</code> accumulator variable before the <code>while</code> loop, and initialize it to be <code>[0, 1, 2]</code>, which is the normal view of channels (each channel goes back into its normal slot).</li>
<li>Add the <code>pattern</code> as an additional input to the <code>processImage</code> function.</li>
<li>Respond to the user in the <code>while</code> loop: if the user presses the space bar, randomly shuffle <code>pattern</code>.</li>
<li>In <code>processImage</code>, after any other changes to the input image are made, do these steps to reshuffle the color channels:
<ul>
<li>Call the <code>cv2.split</code> function, and save the tuple in a variable called <code>channels</code>.</li>
<li>Assign three variables, <code>ch0</code>, <code>ch1</code>, and <code>ch2</code>, to hold the channel from <code>channels</code> based on the index in the shuffle pattern variable: <code>ch0 = channels[pattern[0]]</code>, etc.</li>
<li>Build a new tuple to hold these variables: <code>newChannels = (ch0, ch1, ch2)</code>.</li>
<li>Return the result of <code>cv2.merge</code> called on <code>newChannels</code>.</li>
</ul></li>
</ul>
</section>
</section>
<section id="what-to-hand-in" class="level1">
<h1>What to hand in</h1>
<p>Put all of your function definitions for this activity into a single file to be submitted. Make sure you format your code appropriately:</p>
<ul>
<li>At the top of the file is a triple-quoted string describing the file</li>
<li>Next you include all import statements</li>
<li>Next you have your function definitions, visually separated by blank lines, and maybe comments with dashed or other visual horizontal lines</li>
<li>Each function should have a triple-quoted descriptive comment right after the <code>def</code> line</li>
<li>All calls to all functions should be in a script at the bottom of the file, ideally inside an <code>if __name__ ...</code> block</li>
</ul>
<p>Use <em>commit</em> and <em>push</em> to copy your code to Github to submit this work.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
        for (let i=0; i<annoteTargets.length; i++) {
          const annoteTarget = annoteTargets[i];
          const targetCell = annoteTarget.getAttribute("data-target-cell");
          const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
          const contentFn = () => {
            const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            if (content) {
              const tipContent = content.cloneNode(true);
              tipContent.classList.add("code-annotation-tip-content");
              return tipContent.outerHTML;
            }
          }
          const config = {
            allowHTML: true,
            content: contentFn,
            onShow: (instance) => {
              selectCodeLines(instance.reference);
              instance.reference.classList.add('code-annotation-active');
              window.tippy.hideAll();
            },
            onHide: (instance) => {
              unselectCodeLines();
              instance.reference.classList.remove('code-annotation-active');
            },
            maxWidth: 300,
            delay: [50, 0],
            duration: [200, 0],
            offset: [5, 10],
            arrow: true,
            appendTo: function(el) {
              return el.parentElement.parentElement.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'right',
            popperOptions: {
              modifiers: [
              {
                name: 'flip',
                options: {
                  flipVariations: false, // true by default
                  allowedAutoPlacements: ['right'],
                  fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                },
              },
              {
                name: 'preventOverflow',
                options: {
                  mainAxis: false,
                  altAxis: false
                }
              }
              ]        
            }      
          };
          window.tippy(annoteTarget, config); 
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>