<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Susan Eileen Fox">
<meta name="dcterms.date" content="2025-10-09">

<title>ICA: Masks and Thresholds – Vision Readings</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-226bd0f977fa82dfae4534cac220d79a.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-9011e249e8d359b0658fa71d60c1fa6f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Vision Readings</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">ICA: Masks and Thresholds</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Susan Eileen Fox </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 9, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#masks" id="toc-masks" class="nav-link" data-scroll-target="#masks">Masks</a>
  <ul class="collapse">
  <li><a href="#modifying-the-moving-mask-on-video" id="toc-modifying-the-moving-mask-on-video" class="nav-link" data-scroll-target="#modifying-the-moving-mask-on-video">Modifying the moving mask on video</a></li>
  </ul></li>
  <li><a href="#converting-color-representations" id="toc-converting-color-representations" class="nav-link" data-scroll-target="#converting-color-representations">Converting color representations</a></li>
  <li><a href="#using-the-threshold-function" id="toc-using-the-threshold-function" class="nav-link" data-scroll-target="#using-the-threshold-function">Using the <code>threshold</code> function</a>
  <ul class="collapse">
  <li><a href="#combining-thresholds-with-video-optional" id="toc-combining-thresholds-with-video-optional" class="nav-link" data-scroll-target="#combining-thresholds-with-video-optional">Combining thresholds with video (OPTIONAL)</a></li>
  </ul></li>
  <li><a href="#thresholding-with-color" id="toc-thresholding-with-color" class="nav-link" data-scroll-target="#thresholding-with-color">Thresholding with color</a>
  <ul class="collapse">
  <li><a href="#combining-color-thresholds-with-video-optional" id="toc-combining-color-thresholds-with-video-optional" class="nav-link" data-scroll-target="#combining-color-thresholds-with-video-optional">Combining color thresholds with video (OPTIONAL)</a></li>
  </ul></li>
  <li><a href="#what-to-hand-in" id="toc-what-to-hand-in" class="nav-link" data-scroll-target="#what-to-hand-in">What to hand in</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<section id="overview" class="level1">
<h1>Overview</h1>
<p>In this activity, we will explore how to create and apply masks to images, and how to use the threshold and inRange functions to build threshold images. You will apply these to a variety of images in the SampleImages folder, as well as the BallFinding folder, and to a live webcam.</p>
<p>The Github repository for this assignment will contain a starter code file, <code>activ11.py</code>. Put your code in this file, and create others, as directed below and according to the <code>TODO</code> comments in the file.</p>
<p>Before working on this activity, I encourage you to download the following zip files, unzip them, and move them into the Github repo for this activity.</p>
<ul>
<li><code>BallFinding.zip</code></li>
<li>The updated <code>SampleImages.zip</code></li>
<li><code>SampleVideos.zip</code></li>
</ul>
</section>
<section id="masks" class="level1">
<h1>Masks</h1>
<p>A <strong>mask</strong> is just a black and white image. It can be created by processing a regular image with something like the threshold operations, or you can just make a black image from scratch and then draw white shapes on it.</p>
<p>To <strong>apply</strong> a mask to an image, the mask and the image need to be the same size. Then we use the <code>bitwise_and</code> operation to combine the two. Anywhere that the mask is white, it will keep the other image’s color, and anywhere that the mask is black, it will set the pixel to black.</p>
<p>Below is an example where we mask all but three rectangles of an image.</p>
<div id="69458d1d" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">def</span> maskBuilder(image):</span>
<span id="cb1-2"><a href="#cb1-2"></a>    <span class="co">"""Takes in an image and draws rectangular masks on it."""</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>    (h, w, d) <span class="op">=</span> image.shape</span>
<span id="cb1-4"><a href="#cb1-4"></a>    <span class="bu">print</span>(h, w)</span>
<span id="cb1-5"><a href="#cb1-5"></a>    maskIm <span class="op">=</span> np.zeros(image.shape, image.dtype)</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a>    cv2.rectangle(maskIm, (<span class="dv">0</span>, <span class="dv">0</span>), (w, h <span class="op">//</span> <span class="dv">4</span>), (<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>), <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a>    cv2.rectangle(maskIm, (<span class="dv">200</span>, <span class="dv">2</span> <span class="op">*</span> h <span class="op">//</span> <span class="dv">3</span>), (<span class="dv">400</span>, <span class="dv">5</span> <span class="op">*</span> h <span class="op">//</span> <span class="dv">6</span>), (<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>), <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a>    cv2.rectangle(maskIm, (<span class="dv">3</span> <span class="op">*</span> w <span class="op">//</span> <span class="dv">5</span>, <span class="dv">350</span>), (<span class="dv">3</span> <span class="op">*</span> w <span class="op">//</span> <span class="dv">4</span>, <span class="dv">450</span>), (<span class="dv">255</span>, <span class="dv">255</span>, <span class="dv">255</span>), <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb1-10"><a href="#cb1-10"></a></span>
<span id="cb1-11"><a href="#cb1-11"></a>    <span class="co"># Apply the mask</span></span>
<span id="cb1-12"><a href="#cb1-12"></a>    newMidway <span class="op">=</span> cv2.bitwise_and(midway, maskIm)</span>
<span id="cb1-13"><a href="#cb1-13"></a>    <span class="cf">return</span> maskIm, newMidway</span>
<span id="cb1-14"><a href="#cb1-14"></a></span>
<span id="cb1-15"><a href="#cb1-15"></a>midway <span class="op">=</span> cv2.imread(<span class="st">"SampleImages/mightyMidway.jpg"</span>)</span>
<span id="cb1-16"><a href="#cb1-16"></a>mask, finalIm <span class="op">=</span> maskBuilder(midway)</span>
<span id="cb1-17"><a href="#cb1-17"></a>cv2.imshow(<span class="st">"Final"</span>, finalIm)</span>
<span id="cb1-18"><a href="#cb1-18"></a>cv2.waitKey()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Try this function in <code>activ11.py</code>. Try changing the coordinates of the rectangles, adding shapes, removing shapes.</p>
<section id="modifying-the-moving-mask-on-video" class="level2">
<h2 class="anchored" data-anchor-id="modifying-the-moving-mask-on-video">Modifying the moving mask on video</h2>
<p>In the reading you had a program that connected to the video camera, and showed a masked version of the camera image, where the only part of the video visible was a square that moved from one frame to the next, bouncing around. The <code>activ11.py</code> file contains a function-based version of this program.</p>
<ul>
<li>Try the program out as is, there are sample calls that run it on different video files as well as a webcam</li>
<li>Modify the program so that it draw a circle on the mask image, rather than the square it currently draws</li>
<li>Change the size of the circle drawn</li>
<li>Change the speed and direction of the mask shape’s movement by altering <code>deltaX</code> and <code>deltaY</code></li>
</ul>
</section>
</section>
<section id="converting-color-representations" class="level1">
<h1>Converting color representations</h1>
<p>The <code>cvtColor</code> function in OpenCV will convert an image from one color representation to another. The key to this function is the code that we pass as its second argument. The code tells the function what the representation of the current image is, and what representation we want. Below are some typical conversion codes:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Code</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>cv2.COLOR_BGR2GRAY</code></td>
<td style="text-align: left;">Convert BGR to grayscale</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>cv2.COLOR_BGR2HSV</code></td>
<td style="text-align: left;">Converts BGR to HSV</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>cv2.COLOR_GRAY2BGR</code></td>
<td style="text-align: left;">Converts grayscale to BGR</td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>cv2.COLOR_BGR2RGB</code></td>
<td style="text-align: left;">Converts BGR to RGB</td>
</tr>
<tr class="odd">
<td style="text-align: left;">`cv2.COLOR_BGR2</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>See the <a href="https://docs.opencv.org/4.12.0/d8/d01/group__imgproc__color__conversions.html">Color Space Conversions page</a> in OpenCV’s documentation for a complete list.</p>
<p>The function below is in the activ11.py file. Try it with the sample call in the file, then try varying the image, and examine the results. Do you understand how to use this function?</p>
<div id="652af17b" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">def</span> testConversions(origImage):</span>
<span id="cb2-2"><a href="#cb2-2"></a>    <span class="co">"""Takes in an image, and it converts it to grayscale and HSV. It also converts the grayscale back to BGR,</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">    displays the results, and prints the shapes of the images."""</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>    gray1 <span class="op">=</span> cv2.cvtColor(origImage, cv2.COLOR_BGR2GRAY)</span>
<span id="cb2-5"><a href="#cb2-5"></a>    BGRIm2 <span class="op">=</span> cv2.cvtColor(gray1, cv2.COLOR_GRAY2BGR)</span>
<span id="cb2-6"><a href="#cb2-6"></a>    HSVIm <span class="op">=</span> cv2.cvtColor(origImage, cv2.COLOR_BGR2HSV)</span>
<span id="cb2-7"><a href="#cb2-7"></a></span>
<span id="cb2-8"><a href="#cb2-8"></a>    <span class="bu">print</span>(origImage.shape, gray1.shape, BGRIm2.shape, HSVIm.shape)</span>
<span id="cb2-9"><a href="#cb2-9"></a>    cv2.imshow(<span class="st">"Original"</span>, origImage)</span>
<span id="cb2-10"><a href="#cb2-10"></a>    cv2.imshow(<span class="st">"Gray1"</span>, gray1)</span>
<span id="cb2-11"><a href="#cb2-11"></a>    cv2.imshow(<span class="st">"BGR2"</span>, BGRIm2)</span>
<span id="cb2-12"><a href="#cb2-12"></a>    cv2.imshow(<span class="st">"HSV"</span>, HSVIm)</span>
<span id="cb2-13"><a href="#cb2-13"></a>    cv2.waitKey()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="using-the-threshold-function" class="level1">
<h1>Using the <code>threshold</code> function</h1>
<p>The <code>threshold</code> function takes in a grayscale image and produces a thresholded image that is grayscale, and often black and white. The readings go over all the many different thresholding modes that this function has. We will start with just the basic <code>cv2.THRESH_BINARY</code> mode for today.</p>
<p><strong>Note:</strong> The threshold function returns two values as a tuple. The first value is the threshold that was used, and the second is the actual resulting thresholded image.</p>
<p>The function below takes in an image and a threshold value, and it returns the result of calling <code>threshold</code>.</p>
<div id="f22db457" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">def</span> binaryThresh(image, threshValue<span class="op">=</span><span class="dv">128</span>):</span>
<span id="cb3-2"><a href="#cb3-2"></a>    <span class="co">"""Takes in an image and also has an optional input, threshValue, which can be set by the function call, or</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">    it defaults to the value 128. This function converts the image to grayscale and performs a binary threshold</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">    on it. It returns the resulting image."""</span></span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a>    grayImg <span class="op">=</span> cv2.cvtColor(image, cv2.COLOR_BGR2GRAY)</span>
<span id="cb3-7"><a href="#cb3-7"></a>    tVal, threshIm <span class="op">=</span> cv2.threshold(grayImg, threshValue, <span class="dv">255</span>, cv2.THRESH_BINARY)</span>
<span id="cb3-8"><a href="#cb3-8"></a>    <span class="bu">print</span>(<span class="st">"Threshold value:"</span>, tVal)</span>
<span id="cb3-9"><a href="#cb3-9"></a>    <span class="cf">return</span> threshIm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the <code>activ11.py</code> file, red through this function, and then go to the bottom of the file where we have some sample calls. Try out the samples given to you, and examine the results.</p>
<p>Then, perform these experiments, and record the results either as a comment in the code file, or in a separate <code>.txt</code> file (this next part might be interesting to try with a partner):</p>
<ul>
<li>Write code to try each of the images in the <code>Coins</code> folder (inside <code>SampleImages</code>) with this function. For each image, how well does the <code>binaryThresh</code> function isolate the coins from the background?</li>
<li>Can you modify the threshold value and improve the results? Try a few values and see: report on what you discovered.</li>
<li>Modify this function to use the combination of <code>cv2.THRESH_BINARY</code> and <code>cv2.THRESH_OTSU</code> or <code>cv2.THRESH_TRIANGLE</code> instead of using a fixed threshold value (see readings for how to combine and use these). Evaluate the results on all the coin pictures: does it help?
<ul>
<li>Look at the <code>BallFinding</code> folder, which contains images and videos of brightly colored balls. Pick one or two ball colors, and select one image for each. Try your function on these: how well does it work?</li>
</ul></li>
</ul>
<section id="combining-thresholds-with-video-optional" class="level2">
<h2 class="anchored" data-anchor-id="combining-thresholds-with-video-optional">Combining thresholds with video (OPTIONAL)</h2>
<p>Examine the functions <code>processImage</code> and <code>threshVideo</code>: these are a variation on the <code>videoFeeder</code> program from the last activity. Run the examples to see what it does.</p>
<p>Modify the <code>processImage</code> function so that it calls either <code>cv2.threshold</code> directly, or the <code>binaryThresh</code> function, to perform a threshold on the image. Examine the results. Test this in class using some of my bright and dark colorful balls and other objects.</p>
</section>
</section>
<section id="thresholding-with-color" class="level1">
<h1>Thresholding with color</h1>
<p>The <code>inRange</code> function can isolate colorful objects better than the grayscale-based <code>threshold</code> function. To do this best, we need to work with HSV images, so that hue is a single value that won’t change greatly between well-lit and shadowed pixels of the same object. The inputs to <code>inRange</code> are as shown here:</p>
<div id="4a3a9f36" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1"></a>threshImage <span class="op">=</span> cv2.inRange(colorImage, lowBounds, highBounds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>It assumes that the <code>colorImage</code> is a three-channel color image. We will use HSV rather than BGR for this.</li>
<li>The <code>lowBounds</code> input is a tuple with three values: the lower boundary of acceptable values for each of the three channels</li>
<li>The <code>highBounds</code> input is a tuple with three values: the upper boundary of acceptable values for each of the three channels</li>
</ul>
<p>Remember for HSV images that the three channels represent:</p>
<ul>
<li>Hue: a value between 0 and 180 in OpenCV representing the hue of the pixel (given a global HSV values that ranges from 0 to 360, divide it by 2 to get the corresponding value in OpenCV’s HSV representation)</li>
<li>Saturation: a value between 0 and 255, represents the intensity of the color. Low saturation pixels tend to look gray, high saturation values have an intense version of the color</li>
<li>Value: a value between 0 and 255, represents the brightness of the color. High value pixels are very light, low value pixels are very dark</li>
</ul>
<p>The code snippet below shows how to use <code>inRange</code> on one of the ball pictures:</p>
<div id="f624c7df" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1"></a>ballImg <span class="op">=</span> cv2.imread(<span class="st">"BallFinding/Green/Green1BG1Mid.jpg"</span>)</span>
<span id="cb5-2"><a href="#cb5-2"></a>hsvBall <span class="op">=</span> cv2.cvtColor(ballImg, cv2.COLOR_BGR2HSV)</span>
<span id="cb5-3"><a href="#cb5-3"></a>threshImg <span class="op">=</span> cv2.inRange(hsvBall, (<span class="dv">45</span>, <span class="dv">10</span>, <span class="dv">0</span>), (<span class="dv">65</span>, <span class="dv">255</span>, <span class="dv">255</span>))</span>
<span id="cb5-4"><a href="#cb5-4"></a></span>
<span id="cb5-5"><a href="#cb5-5"></a>cv2.imshow(<span class="st">"Original"</span>, ballImg)</span>
<span id="cb5-6"><a href="#cb5-6"></a>cv2.imshow(<span class="st">"inRange"</span>, threshImg)</span>
<span id="cb5-7"><a href="#cb5-7"></a>cv2.waitKey()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This code is copied in the main script of <code>activ11.py</code>: try it out!</p>
<ul>
<li>Experiment with varying the bounds, changing one value at a time.
<ul>
<li>What happens if we increase the lower bound on saturation?</li>
<li>What if we lower the upper bound on either saturation or value?</li>
<li>What if we broaden or narrow the hue range?</li>
</ul></li>
</ul>
<p>Suppose we wanted to try this on a different picture, with a different color of ball or one of the coin pictures.</p>
<p>To do that, we need to determine the correct range of hue values to pick the ball.</p>
<p>You can do this in one of two ways:</p>
<p><strong>Option 1:</strong></p>
<ul>
<li>Bring up a picture of the object you want to track</li>
<li>Open an online color-picker that displays HSV</li>
<li>Do your best to pick a color close to your target color</li>
<li>Read its hue value, and divide it by 2, then make a range of acceptable hue values that surround it</li>
</ul>
<p><strong>Option 2:</strong></p>
<ul>
<li>Bring up a picture of the object you want to track (some image viewers will let you select colors from the pictures, with</li>
<li>an “eyedropper” tool, but it isn’t universal)</li>
<li>Open a tool to let you select the color from your Desktop (Digital Color Meter on the Mac, on Windows if you have Power Toys it comes with a Color Picker that can report colors from any window on the desktop)</li>
<li>Record the color, probably in RGB, of target pixels from the image</li>
<li>Use an online converter to convert RGB to HSV</li>
</ul>
<p><strong>Try at least one other colorful object</strong></p>
<section id="combining-color-thresholds-with-video-optional" class="level2">
<h2 class="anchored" data-anchor-id="combining-color-thresholds-with-video-optional">Combining color thresholds with video (OPTIONAL)</h2>
<ul>
<li>Copy the <code>threshVideo</code> and <code>processImage</code> functions, and rename them <code>colorThreshVideo</code> and <code>processImage2</code></li>
<li>Change the <code>colorThreshVideo</code> to call <code>processImage2</code> instead of <code>processImage</code></li>
<li>Modify the <code>processImage2</code> function so that it calls <code>cv2.inRange</code> on the input image and returns the result</li>
<li>You can <em>hard-code</em> the color boundaries in the function, so it only looks for one color</li>
<li>Test this on the relevant video files, or try it on the webcam with you holding the correct colorful object (I have external USB cameras if you want to try rolling a ball on the floor)</li>
</ul>
</section>
</section>
<section id="what-to-hand-in" class="level1">
<h1>What to hand in</h1>
<p>Put all of your function definitions for this activity into the <code>activ11.py</code> file to be submitted. Make sure you format your code appropriately:</p>
<ul>
<li>At the top of the file is a triple-quoted string describing the file</li>
<li>Next you include all import statements</li>
<li>Next you have your function definitions, visually separated by blank lines, and maybe comments with dashed or other visual horizontal lines</li>
<li>Each function should have a triple-quoted descriptive comment right after the <code>def</code> line</li>
<li>All calls to all functions should be in a script at the bottom of the file, ideally inside an <code>if __name__ ...</code> block</li>
</ul>
<p>Use <em>commit</em> and <em>push</em> to copy your code to Github to submit this work.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
        for (let i=0; i<annoteTargets.length; i++) {
          const annoteTarget = annoteTargets[i];
          const targetCell = annoteTarget.getAttribute("data-target-cell");
          const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
          const contentFn = () => {
            const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            if (content) {
              const tipContent = content.cloneNode(true);
              tipContent.classList.add("code-annotation-tip-content");
              return tipContent.outerHTML;
            }
          }
          const config = {
            allowHTML: true,
            content: contentFn,
            onShow: (instance) => {
              selectCodeLines(instance.reference);
              instance.reference.classList.add('code-annotation-active');
              window.tippy.hideAll();
            },
            onHide: (instance) => {
              unselectCodeLines();
              instance.reference.classList.remove('code-annotation-active');
            },
            maxWidth: 300,
            delay: [50, 0],
            duration: [200, 0],
            offset: [5, 10],
            arrow: true,
            appendTo: function(el) {
              return el.parentElement.parentElement.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'right',
            popperOptions: {
              modifiers: [
              {
                name: 'flip',
                options: {
                  flipVariations: false, // true by default
                  allowedAutoPlacements: ['right'],
                  fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                },
              },
              {
                name: 'preventOverflow',
                options: {
                  mainAxis: false,
                  altAxis: false
                }
              }
              ]        
            }      
          };
          window.tippy(annoteTarget, config); 
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>