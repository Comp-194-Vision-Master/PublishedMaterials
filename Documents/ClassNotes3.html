<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.23">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Susan Eileen Fox">
<meta name="dcterms.date" content="2025-10-31">

<title>Comp 194 Class Notes - Weeks 8-11 – Vision Readings</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-226bd0f977fa82dfae4534cac220d79a.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-9011e249e8d359b0658fa71d60c1fa6f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Vision Readings</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Comp 194 Class Notes - Weeks 8-11</h1>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Susan Eileen Fox </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 31, 2025</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#week-8" id="toc-week-8" class="nav-link active" data-scroll-target="#week-8">Week 8</a>
  <ul class="collapse">
  <li><a href="#monday-october-20" id="toc-monday-october-20" class="nav-link" data-scroll-target="#monday-october-20">Monday, October 20</a>
  <ul class="collapse">
  <li><a href="#announcements" id="toc-announcements" class="nav-link" data-scroll-target="#announcements">Announcements</a></li>
  <li><a href="#todays-topics" id="toc-todays-topics" class="nav-link" data-scroll-target="#todays-topics">Today’s topics</a></li>
  <li><a href="#resizing" id="toc-resizing" class="nav-link" data-scroll-target="#resizing">Resizing</a></li>
  <li><a href="#affine-warping" id="toc-affine-warping" class="nav-link" data-scroll-target="#affine-warping">Affine warping</a></li>
  <li><a href="#translation" id="toc-translation" class="nav-link" data-scroll-target="#translation">Translation</a></li>
  </ul></li>
  <li><a href="#wednesday-october-22" id="toc-wednesday-october-22" class="nav-link" data-scroll-target="#wednesday-october-22">Wednesday, October 22</a>
  <ul class="collapse">
  <li><a href="#announcements-1" id="toc-announcements-1" class="nav-link" data-scroll-target="#announcements-1">Announcements</a></li>
  <li><a href="#todays-topis" id="toc-todays-topis" class="nav-link" data-scroll-target="#todays-topis">Today’s Topis</a></li>
  </ul></li>
  <li><a href="#friday-october-24" id="toc-friday-october-24" class="nav-link" data-scroll-target="#friday-october-24">Friday, October 24</a>
  <ul class="collapse">
  <li><a href="#todays-topis-1" id="toc-todays-topis-1" class="nav-link" data-scroll-target="#todays-topis-1">Today’s Topis</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#week-9" id="toc-week-9" class="nav-link" data-scroll-target="#week-9">Week 9</a>
  <ul class="collapse">
  <li><a href="#monday-october-27" id="toc-monday-october-27" class="nav-link" data-scroll-target="#monday-october-27">Monday, October 27</a>
  <ul class="collapse">
  <li><a href="#announcements-2" id="toc-announcements-2" class="nav-link" data-scroll-target="#announcements-2">Announcements</a></li>
  <li><a href="#todays-topics-1" id="toc-todays-topics-1" class="nav-link" data-scroll-target="#todays-topics-1">Today’s topics</a></li>
  <li><a href="#short-essays-overview" id="toc-short-essays-overview" class="nav-link" data-scroll-target="#short-essays-overview">Short essays overview</a></li>
  <li><a href="#extended-essay-overview" id="toc-extended-essay-overview" class="nav-link" data-scroll-target="#extended-essay-overview">Extended essay overview</a></li>
  <li><a href="#project-overview" id="toc-project-overview" class="nav-link" data-scroll-target="#project-overview">Project overview</a></li>
  </ul></li>
  <li><a href="#wednesday-october-29" id="toc-wednesday-october-29" class="nav-link" data-scroll-target="#wednesday-october-29">Wednesday, October 29</a>
  <ul class="collapse">
  <li><a href="#announcements-3" id="toc-announcements-3" class="nav-link" data-scroll-target="#announcements-3">Announcements</a></li>
  <li><a href="#todays-topics-2" id="toc-todays-topics-2" class="nav-link" data-scroll-target="#todays-topics-2">Today’s topics</a></li>
  <li><a href="#discussion-today" id="toc-discussion-today" class="nav-link" data-scroll-target="#discussion-today">Discussion today</a></li>
  </ul></li>
  <li><a href="#friday-october-31" id="toc-friday-october-31" class="nav-link" data-scroll-target="#friday-october-31">Friday, October 31</a>
  <ul class="collapse">
  <li><a href="#announcements-4" id="toc-announcements-4" class="nav-link" data-scroll-target="#announcements-4">Announcements</a></li>
  <li><a href="#todays-topics-3" id="toc-todays-topics-3" class="nav-link" data-scroll-target="#todays-topics-3">Today’s topics</a></li>
  <li><a href="#motion-detection" id="toc-motion-detection" class="nav-link" data-scroll-target="#motion-detection">Motion detection</a></li>
  <li><a href="#background-subtraction" id="toc-background-subtraction" class="nav-link" data-scroll-target="#background-subtraction">Background subtraction</a></li>
  <li><a href="#camshift-color-detection" id="toc-camshift-color-detection" class="nav-link" data-scroll-target="#camshift-color-detection">CAMShift color detection</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#additional-class-notes-documents" id="toc-additional-class-notes-documents" class="nav-link" data-scroll-target="#additional-class-notes-documents">Additional Class Notes documents</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<hr>
<section id="week-8" class="level1">
<h1>Week 8</h1>
<section id="monday-october-20" class="level2">
<h2 class="anchored" data-anchor-id="monday-october-20">Monday, October 20</h2>
<section id="announcements" class="level3">
<h3 class="anchored" data-anchor-id="announcements">Announcements</h3>
<ul>
<li>Homework 3 posted later today, start on it soon! Due November 7
<ul>
<li>Focused on computer vision applications, particularly thresholds, masks, geometric transformations, filters, etc.</li>
</ul></li>
<li>Be prepared to discuss Ethics and Sci-Fi 7 <strong>Friday</strong>
<ul>
<li>This is a story only in print, not online… There is a copy on reserve at the library and also on my office door</li>
</ul></li>
<li>Midterm grades
<ul>
<li>I updated your Alternative Grading Record spreadsheets with the 4-homework revisions</li>
<li>Also added an estimate for what you are on track for at this point</li>
<li>I will figure out some grade to report</li>
<li>I will also send you an email detailing where you are and what you might need to improve on during the second half</li>
</ul></li>
<li>Focus for the next week or two is on OpenCV, image transformations and getting information out of images (without ML)
<ul>
<li>Don’t expect to memorize the OpenCV functions and their inputs, but <strong>do</strong> focus on remembering where to look them up!</li>
</ul></li>
<li>Altering office hours: Tell me which options would be helpful to you, suggest other times if none of them work for you</li>
</ul>
</section>
<section id="todays-topics" class="level3">
<h3 class="anchored" data-anchor-id="todays-topics">Today’s topics</h3>
<ul>
<li>Geometric transformations in general</li>
<li>Resizing</li>
<li>Translation</li>
<li>Rotation</li>
<li>Warping</li>
</ul>
</section>
<section id="resizing" class="level3">
<h3 class="anchored" data-anchor-id="resizing">Resizing</h3>
<p><strong>Making an image smaller:</strong></p>
<ul>
<li>When we make an image smaller, we are losing some <em>information</em> (some pixels go away)</li>
<li>We can make an image half size in a <em>brute-force</em> way with slicing: <code>image[::2, ::2, :]</code></li>
<li>We would like more flexible size reductions, and the best quality result</li>
<li>We need to <strong>interpolate</strong> the new pixel values to preserve the image as much as possible</li>
</ul>
<p><strong>Making an image larger:</strong></p>
<ul>
<li>When we make an image larger, we have more pixels to fill than we have data!</li>
<li>If we just make copies of each pixel, the image is rapidly <em>pixelated</em> (we have made larger blocks of a single color)</li>
<li>We again need to <strong>interpolate</strong> new color values to fill in the new pixels</li>
</ul>
<p><strong>OpenCV’s <code>resize</code> function:</strong></p>
<ul>
<li>Can resize by specifying new height and width <strong>or</strong> by scaling old height or width</li>
<li>Has alternate algorithms for interpolation (you can try them out if you like)</li>
</ul>
<div id="94f8fa80" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="annotated-cell-1"><pre class="sourceCode numberSource python code-annotation-code number-lines code-with-copy code-annotated"><code class="sourceCode python"><button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1">1</button><span id="annotated-cell-1-1" class="code-annotation-target"><a href="#annotated-cell-1-1"></a>img1 <span class="op">=</span> cv2.imread(<span class="st">"SampleImages/bryceCanyon.jpg"</span>)</span>
<span id="annotated-cell-1-2"><a href="#annotated-cell-1-2"></a>cv2.imshow(<span class="st">"Original"</span>, img1)</span>
<span id="annotated-cell-1-3"><a href="#annotated-cell-1-3"></a>cv2.waitKey()</span>
<span id="annotated-cell-1-4"><a href="#annotated-cell-1-4"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2">2</button><span id="annotated-cell-1-5" class="code-annotation-target"><a href="#annotated-cell-1-5"></a>img2 <span class="op">=</span> img1[::<span class="dv">2</span>, ::<span class="dv">2</span>, :]</span>
<span id="annotated-cell-1-6"><a href="#annotated-cell-1-6"></a>cv2.imshow(<span class="st">"Resized"</span>, img2)</span>
<span id="annotated-cell-1-7"><a href="#annotated-cell-1-7"></a>cv2.waitKey()</span>
<span id="annotated-cell-1-8"><a href="#annotated-cell-1-8"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="3">3</button><span id="annotated-cell-1-9" class="code-annotation-target"><a href="#annotated-cell-1-9"></a>img3 <span class="op">=</span> cv2.resize(img1, (<span class="dv">200</span>, <span class="dv">200</span>))</span>
<span id="annotated-cell-1-10"><a href="#annotated-cell-1-10"></a>cv2.imshow(<span class="st">"Resized"</span>, img3)</span>
<span id="annotated-cell-1-11"><a href="#annotated-cell-1-11"></a>cv2.waitKey()</span>
<span id="annotated-cell-1-12"><a href="#annotated-cell-1-12"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="4">4</button><span id="annotated-cell-1-13" class="code-annotation-target"><a href="#annotated-cell-1-13"></a>img4 <span class="op">=</span> cv2.resize(img1, (<span class="dv">0</span>, <span class="dv">0</span>), fx <span class="op">=</span> <span class="fl">0.75</span>, fy <span class="op">=</span> <span class="fl">0.75</span>)</span>
<span id="annotated-cell-1-14"><a href="#annotated-cell-1-14"></a>cv2.imshow(<span class="st">"Resized"</span>, img4)</span>
<span id="annotated-cell-1-15"><a href="#annotated-cell-1-15"></a>cv2.waitKey()</span>
<span id="annotated-cell-1-16"><a href="#annotated-cell-1-16"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="5">5</button><span id="annotated-cell-1-17" class="code-annotation-target"><a href="#annotated-cell-1-17"></a>img5 <span class="op">=</span> cv2.resize(img1, (<span class="dv">0</span>, <span class="dv">0</span>), fx<span class="op">=</span><span class="fl">1.0</span>, fy<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="annotated-cell-1-18"><a href="#annotated-cell-1-18"></a>cv2.imshow(<span class="st">"Resized"</span>, img5)</span>
<span id="annotated-cell-1-19"><a href="#annotated-cell-1-19"></a>cv2.waitKey()</span>
<span id="annotated-cell-1-20"><a href="#annotated-cell-1-20"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="6">6</button><span id="annotated-cell-1-21" class="code-annotation-target"><a href="#annotated-cell-1-21"></a>img6 <span class="op">=</span> cv2.resize(img1, (<span class="dv">0</span>, <span class="dv">0</span>), fx <span class="op">=</span> <span class="fl">1.5</span>, fy <span class="op">=</span> <span class="fl">1.5</span>)</span>
<span id="annotated-cell-1-22"><a href="#annotated-cell-1-22"></a>cv2.imshow(<span class="st">"Resized"</span>, img6)</span>
<span id="annotated-cell-1-23"><a href="#annotated-cell-1-23"></a>cv2.waitKey()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="1" data-code-annotation="1">The original image, with its original size and aspect ratio</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="5" data-code-annotation="2">Resized to half size using array slicing (brute force)</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="9" data-code-annotation="3">Resized to 200x200, squashing the image width to equal its height</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="13" data-code-annotation="4">Resized to 3/4 of its original size, preserving the aspect ratio (for the most part)</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="17" data-code-annotation="5">Resized to make the height half the original, width unchanged</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="21" data-code-annotation="6">Resized to be 1.5 times its original size, preserving the aspect ratio</span>
</dd>
</dl>
</div>
</div>
</section>
<section id="affine-warping" class="level3">
<h3 class="anchored" data-anchor-id="affine-warping">Affine warping</h3>
<p>For the other geometric transformation, we will only look at <strong>affine warping</strong></p>
<p><span class="math display">\[x_{new} = a \cdot x_{old} + b \cdot y_{old} + t_x\]</span></p>
<p><span class="math display">\[y_{new} = c \cdot x_{old} + d \cdot y_{old} + t_y\]</span></p>
<p>We can write these in terms of matrix and vector operations, like this:</p>
<p><span class="math display">\[
\begin{bmatrix}
x_{new} \\
y_{new} \\
1
\end{bmatrix} =
\begin{bmatrix}
a &amp; b &amp; t_x \\
c &amp; d &amp; t_y \\
0 &amp; 0 &amp; 1 \\
\end{bmatrix}
\cdot \begin{bmatrix}
x_{old} \\
y_{old} \\
1
\end{bmatrix}
\]</span></p>
<p>Depending on the values for <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, <span class="math inline">\(c\)</span>, <span class="math inline">\(d\)</span>, and <span class="math inline">\(t_x\)</span> and <span class="math inline">\(t_y\)</span>, we change the view of the image in very different ways (translating, rotating, skewing, stretching/squashing, … warping!)</p>
<p>All of these geometric transformation will be done with the <code>warpAffine</code> function. To call it we do this:</p>
<div id="693570c9" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1"></a>newImage <span class="op">=</span> cv2.warpAffine(oldImage, matrix, size)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The function takes in three inputs:</p>
<ul>
<li><code>oldImage</code>, the old image we want to transform</li>
<li><code>matrix</code>, a 2x3 matrix of 32-bit floating-point numbers, it gives the six values from the formulas above <span class="math display">\[
\begin{bmatrix}
a &amp; b &amp; t_x \\
c &amp; d &amp; t_y \\
\end{bmatrix}
\]</span></li>
<li><code>size</code>, a tuple of width and height for the new image</li>
</ul>
</section>
<section id="translation" class="level3">
<h3 class="anchored" data-anchor-id="translation">Translation</h3>
<p>When we translate an image, we move all the pixels right or left by some fixed amount, and up or down as well. Translation is the simplest of the affine warp transformations. Because of this, OpenCV doesn’t provide a helper function to help us to create the 2x3 matrix that the <code>warpAffine</code> function needs.</p>
<p><strong>A simple example:</strong></p>
<div id="79b1beb3" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource python number-lines code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1"></a>astilIm <span class="op">=</span> cv2.imread(<span class="st">"SampleImages/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="wednesday-october-22" class="level2">
<h2 class="anchored" data-anchor-id="wednesday-october-22">Wednesday, October 22</h2>
<section id="announcements-1" class="level3">
<h3 class="anchored" data-anchor-id="announcements-1">Announcements</h3>
<ul>
<li>Homework 3, due November 7!</li>
<li>Coding quiz redos: through the end of next week</li>
<li>Office hours changing</li>
<li>Be prepared to discuss Ethics and Sci-Fi 7 <strong>Friday!</strong></li>
<li><strong>Midterm Grades:</strong>*</li>
</ul>
</section>
<section id="todays-topis" class="level3">
<h3 class="anchored" data-anchor-id="todays-topis">Today’s Topis</h3>
<ul>
<li>Image filters</li>
<li>Morphological filters
<ul>
<li>Erosion and dilation</li>
<li>Opening and closing</li>
<li>Black hat and top hat</li>
<li>Gradient</li>
</ul></li>
<li>Convolutional filters
<ul>
<li>Blurring</li>
<li>Edge detection</li>
</ul></li>
</ul>
<p>See Readings document for details…</p>
</section>
</section>
<section id="friday-october-24" class="level2">
<h2 class="anchored" data-anchor-id="friday-october-24">Friday, October 24</h2>
<p><strong>Advising:</strong></p>
<ul>
<li>Midterm grades are out now
<ul>
<li>Come talk to me if you have concerns about this class, or your others</li>
<li>Go talk to your professors if you are surprised or unsure about your midterm grade</li>
</ul></li>
<li>Upcoming dates:
<ul>
<li>November 7: Last Day to Withdraw from a Class</li>
<li>November 10: First Day to Designate Grading Option</li>
<li>November 10:Registration for Spring 2026 courses begins
<ul>
<li>Nov 10-11, Seniors</li>
<li>Nov 12-13, Juniors</li>
<li>Nov 14-17, Sophomores</li>
<li>Nov 18-19, First-years</li>
<li>Nov 20-21, Wrap up days</li>
</ul></li>
</ul></li>
</ul>
<p><strong>MSCS:</strong></p>
<ul>
<li>Tuesday, 8:30-9:30am: Hot Chocolate with the MSCS Student Advisory Board (SAB)
<ul>
<li>Stop by to meet other MSCS students and members of SAB. Relatedly, are you a first year, sophomore, junior, or senior MSCS student / major / minor dedicated to building a welcoming, supportive, and inclusive MSCS community? Please consider applying to become a SAB member yourself! For more information about SAB and applications (due 11/4 by 11:00am), please check out this google form.</li>
</ul></li>
<li>Tuesday, 12:00-1:00pm: MSCS seminar with Mac Prof Dan Drake
<ul>
<li>Skeptical that “bad predictions” are sometimes better?! Come to this talk.</li>
</ul></li>
<li>Thursday, 3:00-4:30pm: weekly Math problem solving
<ul>
<li>Please drop in. All experience levels welcome!</li>
</ul></li>
</ul>
<p><strong>Our class:</strong></p>
<ul>
<li>Homework 3, due November 7!</li>
<li>Coding quiz redos: through the end of next week</li>
<li>Office hours changing next week:
<ul>
<li>Monday + Wednesday: 4:30-5:30pm</li>
<li>Tuesday + Thursday: 3:00-4:30pm</li>
<li>By-appointment times: MW, 10:30-11:30 or MWF 1:00-2:00</li>
</ul></li>
<li>Be prepared to discuss Ethics and Sci-Fi 7 <strong>Today</strong></li>
</ul>
<section id="todays-topis-1" class="level3">
<h3 class="anchored" data-anchor-id="todays-topis-1">Today’s Topis</h3>
<ul>
<li>Image filters</li>
<li>Convolutional filters
<ul>
<li>Edge detection</li>
</ul></li>
</ul>
<p>See Readings for details!</p>
</section>
</section>
</section>
<section id="week-9" class="level1">
<h1>Week 9</h1>
<section id="monday-october-27" class="level2">
<h2 class="anchored" data-anchor-id="monday-october-27">Monday, October 27</h2>
<section id="announcements-2" class="level3">
<h3 class="anchored" data-anchor-id="announcements-2">Announcements</h3>
<ul>
<li>Homework 3: start on it soon! Due November 7
<ul>
<li>Focused on computer vision applications, particularly thresholds, masks, geometric transformations, filters, etc.</li>
</ul></li>
<li>Be prepared to discuss Ethics and Sci-Fi 8 <strong>Friday</strong></li>
<li>New office hours: MW 4:30-5:30, TR 3:00-4:30, plus some “by appointment” hours earlier in the day (see calendar)</li>
</ul>
</section>
<section id="todays-topics-1" class="level3">
<h3 class="anchored" data-anchor-id="todays-topics-1">Today’s topics</h3>
<ul>
<li>Upcoming essays
<ul>
<li>2 short essays, started in class</li>
<li>Extended essay, requires some library research, connected (loosely) to team project</li>
</ul></li>
<li>Starting to think about the project
<ul>
<li>Team project: groups of 2 or 3</li>
<li>Must involve OpenCV, Mediapipe, Tensorflow</li>
<li>Programming project with milestones</li>
</ul></li>
</ul>
</section>
<section id="short-essays-overview" class="level3">
<h3 class="anchored" data-anchor-id="short-essays-overview">Short essays overview</h3>
<p>See <a href="https://docs.google.com/document/d/1dQWdiLw6L5iBpqdcVGqBQaT96_TcCOn0n2voi-QtBFU/edit?usp=sharing">Short Essay Guide</a> and <a href="https://docs.google.com/document/d/1KFVAqArIK0oR3N0hIn3JDAscaU1DuI08Y4NCsPb-TGY/edit?usp=sharing">Short Essay Rubric</a></p>
<ul>
<li>General subject announced ahead of time</li>
<li>Bring any paper notes you would find helpful</li>
<li>Specific prompt given at the start of class: 40 minutes to think, review notes, and outline/write a draft of the essay</li>
<li>Last 20 minutes of class, meet with a peer and exchange outlines/drafts and give feedback about them</li>
<li>Feedback from me after that class, about 1 week to finish the paper</li>
</ul>
<p><strong>Short essay 1 will include prompts that focus on themes around privacy: personal and data privacy, surveillance by government, society, or other individuals, expectations of privacy or anonymity in a modern, “connected” society</strong></p>
</section>
<section id="extended-essay-overview" class="level3">
<h3 class="anchored" data-anchor-id="extended-essay-overview">Extended essay overview</h3>
<p>See <a href="https://docs.google.com/document/d/1ZvgJNCfRoI6yPPTkx0iEb1B2rKRCD1TZKOHIdrfmkTw/edit?usp=sharing">Extended Essay Guide</a> and <a href="https://docs.google.com/document/d/1jOCFlSMTMmmHkhW8ZYaiLZQF8vPri4K_bhzt27Jxz4o/edit?usp=sharing">Extended Essay Rubric</a></p>
<p>Extended essay will be about AI or personal ethics, or social issues caused by the use of AI, as these connect to computer vision, particularly your team project topic.</p>
<p><strong>Activity: read through rubric, read through a paper assigned for this week, and look at how they connect to each other</strong></p>
</section>
<section id="project-overview" class="level3">
<h3 class="anchored" data-anchor-id="project-overview">Project overview</h3>
<ul>
<li>Team project (2-3 is the norm, see me if you have reasons for exceptions)</li>
<li>Projects must use OpenCV, Mediapipe, or Tensorflow</li>
<li><strong>WIDE</strong> range of project topics, suitable to a wide range of programming experience</li>
</ul>
<p><strong>Activity: Read through the project overview document, and then add your name to projects that sound interesting to you</strong></p>
</section>
</section>
<section id="wednesday-october-29" class="level2">
<h2 class="anchored" data-anchor-id="wednesday-october-29">Wednesday, October 29</h2>
<section id="announcements-3" class="level3">
<h3 class="anchored" data-anchor-id="announcements-3">Announcements</h3>
<ul>
<li>Homework 3: start on it soon! Due November 7
<ul>
<li>Focused on computer vision applications, particularly thresholds, masks, geometric transformations, filters, etc.</li>
</ul></li>
<li>Be prepared to discuss Ethics and Sci-Fi 8 <strong>Friday</strong></li>
<li>New office hours: MW 4:30-5:30, TR 3:00-4:30, plus some “by appointment” hours earlier in the day (see calendar)</li>
<li>Coding quiz redos: Through Friday (see me if that’s an issue)</li>
<li>Homework question redos:
<ul>
<li>You fix your submission</li>
<li>You come to see me and explain what you changed/did</li>
<li>I regrade your new submission</li>
</ul></li>
</ul>
</section>
<section id="todays-topics-2" class="level3">
<h3 class="anchored" data-anchor-id="todays-topics-2">Today’s topics</h3>
<ul>
<li>Finding contours
<ul>
<li>What are they?</li>
<li>The <code>findContours</code> function</li>
</ul></li>
<li>Functions that manipulate contours</li>
</ul>
</section>
<section id="discussion-today" class="level3">
<h3 class="anchored" data-anchor-id="discussion-today">Discussion today</h3>
<ul>
<li>Look back at the <a href="https://miro.com/app/live-embed/uXjVJ03srbc=/?embedMode=view_only_without_ui&amp;moveToViewport=-60%2C-930%2C2387%2C1511&amp;embedId=139306806391">Project Ideas Brainstorming Miro board</a> from last time: Write down your top 3-4 project ideas</li>
<li>Discuss your ideas with your group</li>
<li>Look at the Comprehension Quiz questions for today</li>
<li>Post questions to the <a href="https://miro.com/app/live-embed/uXjVIgguG5c=/?embedMode=view_only_without_ui&amp;moveToViewport=-3124%2C-6845%2C28853%2C18273&amp;embedId=962367137115">In-Class Discussion Notes Miro board</a>
<ul>
<li>Questions about essays</li>
<li>Questions about project</li>
<li>Questions about today’s topic</li>
</ul></li>
</ul>
<p>Going to use the readings here for examples</p>
</section>
</section>
<section id="friday-october-31" class="level2">
<h2 class="anchored" data-anchor-id="friday-october-31">Friday, October 31</h2>
<section id="announcements-4" class="level3">
<h3 class="anchored" data-anchor-id="announcements-4">Announcements</h3>
<ul>
<li>Homework 3: start on it soon! Due November 7
<ul>
<li>Focused on computer vision applications, particularly thresholds, masks, geometric transformations, filters, etc.</li>
</ul></li>
<li>Be prepared to discuss Ethics and Sci-Fi 8 <strong>Friday</strong></li>
<li>New office hours: MW 4:30-5:30, TR 3:00-4:30, plus some “by appointment” hours earlier in the day (see calendar)</li>
<li>Coding quiz redos: Through Sunday</li>
<li>Homework question redos:
<ul>
<li>You fix your submission</li>
<li>You come to see me and explain what you changed/did</li>
<li>I regrade your new submission</li>
</ul></li>
<li><strong>REMEMBER: Prepare notes for Monday’s in-class essay-writing activity</strong>
<ul>
<li>General topic is about privacy and surveillance</li>
<li>Specific prompts will be given on Monday: you will choose one of three options</li>
<li>Prompts will ask you to draw on examples/evidence from Ethics and Sci-Fi stories, other readings, and videos</li>
<li>You may bring and use any amount of paper notes you like</li>
<li>No computers on Monday</li>
<li>First 40 minutes of class: choosing your thesis and writing an outline, or even starting to draft your paper</li>
<li>Last 20 minutes of class: exchanging ideas with a peer and giving/getting feedback/ideas from them</li>
</ul></li>
</ul>
</section>
<section id="todays-topics-3" class="level3">
<h3 class="anchored" data-anchor-id="todays-topics-3">Today’s topics</h3>
<ul>
<li>Motion Detection</li>
<li>Background Subtraction</li>
<li>CamShift color-tracking</li>
</ul>
</section>
<section id="motion-detection" class="level3">
<h3 class="anchored" data-anchor-id="motion-detection">Motion detection</h3>
<ul>
<li>Compute the difference between current frame of video and the previous one</li>
<li>Process that with thresholding, etc. to find where motion is</li>
<li>Good at detecting edges of moving objects</li>
</ul>
</section>
<section id="background-subtraction" class="level3">
<h3 class="anchored" data-anchor-id="background-subtraction">Background subtraction</h3>
<ul>
<li>Keeps a background image, or “model” of background</li>
<li>Computes difference between frame and background model</li>
<li>Process that with thresholding etc. to find where foreground, moving objects are</li>
</ul>
<p><strong>MOG2: Mixture of Gaussians</strong></p>
<ul>
<li>At each pixel, collect up the color values over time</li>
<li>Compute the variation in those color values</li>
<li>Describe the variation as a function: a mixture of gaussian curves: <span class="math inline">\(P(x, y) = a \cdot G_1(x, y) + b \cdot G_2(x, y) + c \cdot G_3(x, y)\)</span>
<ul>
<li>Function returns the probability of a pixel being background</li>
</ul></li>
<li>Use functions to determine which pixels are background, set them to zero</li>
</ul>
<p><strong>KNN: K Nearest Neighbors</strong></p>
<ul>
<li>At each pixel, collect up the color values over time</li>
<li>Determine the minimum size sphere (R, G, and B dimensions) that encloses at least K of the color values</li>
<li>If a new pixel color is within the sphere, it is background, otherwise it is foreground</li>
</ul>
</section>
<section id="camshift-color-detection" class="level3">
<h3 class="anchored" data-anchor-id="camshift-color-detection">CAMShift color detection</h3>
<ul>
<li>Keeps a track window that encloses the object being tracked (initialized to the whole window, algorithm shrinks it)</li>
<li>Uses a hue histogram and performs backprojection to determine probability of each pixel <strong>in the track window</strong> being the target color</li>
<li>Camshift function then:
<ul>
<li>Computes the <em>center of mass</em> of the track window</li>
<li>If that is at the center, then the track window is centered on the object: change its size and return it</li>
<li>Otherwise, move track window to center on center of mass, and repeat</li>
</ul></li>
</ul>
<hr>
</section>
</section>
</section>
<section id="additional-class-notes-documents" class="level1">
<h1>Additional Class Notes documents</h1>
<ul>
<li><a href="ClassNotes1.html">Class notes for weeks 0-3</a></li>
<li><a href="../Documents/ClassNotes2.html">Class notes for weeks 4-7</a></li>
<li>Class notes for weeks 8-11 (This document)</li>
<li><a href="ClassNotes4.html">Class notes for weeks 12-15</a></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
        for (let i=0; i<annoteTargets.length; i++) {
          const annoteTarget = annoteTargets[i];
          const targetCell = annoteTarget.getAttribute("data-target-cell");
          const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
          const contentFn = () => {
            const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            if (content) {
              const tipContent = content.cloneNode(true);
              tipContent.classList.add("code-annotation-tip-content");
              return tipContent.outerHTML;
            }
          }
          const config = {
            allowHTML: true,
            content: contentFn,
            onShow: (instance) => {
              selectCodeLines(instance.reference);
              instance.reference.classList.add('code-annotation-active');
              window.tippy.hideAll();
            },
            onHide: (instance) => {
              unselectCodeLines();
              instance.reference.classList.remove('code-annotation-active');
            },
            maxWidth: 300,
            delay: [50, 0],
            duration: [200, 0],
            offset: [5, 10],
            arrow: true,
            appendTo: function(el) {
              return el.parentElement.parentElement.parentElement;
            },
            interactive: true,
            interactiveBorder: 10,
            theme: 'quarto',
            placement: 'right',
            popperOptions: {
              modifiers: [
              {
                name: 'flip',
                options: {
                  flipVariations: false, // true by default
                  allowedAutoPlacements: ['right'],
                  fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
                },
              },
              {
                name: 'preventOverflow',
                options: {
                  mainAxis: false,
                  altAxis: false
                }
              }
              ]        
            }      
          };
          window.tippy(annoteTarget, config); 
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>